{% extends "base_site.html" %}
{% load i18n %}
{% load static %}
{% load pbs_utils %}

{% block extrajs %}
  <script src="{% static 'js/toggle_columns.js' %}"></script>
{% endblock %}
{% block content_title %}
    <h1>{{ title }}</h1>
    <div class="row toggletools">
    <div class="span12">
        <div class="alert alert-success">
            <strong>Filter</strong>
            <div class="row">
                <div class="filter-tools btn-group span12" style="white-space:normal;">
                    <form id="id_form_filtering" action="" method="post">
                        {% for field in filterform %}
                            {% call_method field "html" "{widget}" %}
                        {% endfor %}

                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="span12">
        <div class="alert alert-info">
            <strong>Show/Hide Columns</strong>
            <div class="column-tools btn-group" style="white-space:normal;" id="{{listform.model_name_lower}}_toggle_columns">
                {% for field in listform.toggleablefields %}
                    <button id="template-button" class="btn btn-small btn-info hide">template-button</button>
                    {% call_method field "html_toggle" "<button id=\"toggle-{name}\" class=\"btn btn-small {activeclass}\" data-class=\"{name}\">{label}</button>"%}
                {% endfor %}
            </div>
        </div>
        <script type="text/javascript">
            var {{listform.model_name_lower}}_toggle_columns = new ToggleTableColumn("{{listform.model_name_lower}}","#{{listform.model_name_lower}}_toggle_columns button","#{{listform.model_name_lower}}_result_list");
            $(document).ready(function(){{
                {{listform.model_name_lower}}_toggle_columns.init();
            }})
        </script>
    </div>
    <div class="span12">
        <br>
    </div>
    </div>
{% endblock %}

{% block content %}
<div>

{% if listform.errors %}
    <p class="errornote alert alert-block alert-error fade in">
    {% blocktrans count counter=errors|length %}Please correct the error below.{% plural %}Please correct the errors below.{% endblocktrans %}
    </p>
{% endif %}
<div class="row">
<div class="span12">
<div id="id_pageerrors"><span id="id__all__">
    {% if listform.non_field_errors %}
        {% include "display_errors.html" with errors=listform.non_field_errors %}
    {% endif %}
</span></div>

<form action="" method="post">{% csrf_token %}
    {% block form_content%}
    <table id="{{listform.model_name_lower}}_result_list" class="table table-striped table-condensed table-hober table-fixed-header">
        <thead>
            <tr>
                {% for field in listform.boundfields %}
                {% call_method field "html_header" "<th{attrs}><div class=\"text\"> {label}</div></th>"%}
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for dataform in listform %}
            <tr> 
                {% for field in dataform %}
                    {% call_method field "html" "<td{attrs}>{widget}</td>"%}
                {% endfor %}
            </tr>
            {% endfor %}

        </tbody>
    </table>
    {% endblock %}
</form>
{% include "pagination.html" %}
</div>
</div>
</div>
{% endblock %}
